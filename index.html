<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Terminal Pro - Simulator</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #050505; color: white; padding: 10px; margin: 0; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #111; border-radius: 12px; margin-bottom: 10px; border: 1px solid #333; }
        .balance-numb { color: #00ff00; font-weight: bold; font-size: 1.1rem; }
        
        #contenedor-grafica { width: 100%; height: 260px; background: #000; border-radius: 15px; overflow: hidden; margin-bottom: 15px; border: 1px solid #333; }
        
        .trade-panel { background: #111; padding: 15px; border-radius: 15px; border: 1px solid #333; margin-bottom: 15px; }
        input { width: 100%; background: #222; border: 1px solid #444; color: white; padding: 12px; margin: 10px 0; border-radius: 8px; box-sizing: border-box; }
        
        .btn-group { display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .btn-buy { background: #00ff00; color: #000; }
        .btn-sell { background: #ff4444; color: #fff; }
        .btn-binance { background: #f3ba2f; color: #000; width: 100%; margin-top: 15px; padding: 10px; border-radius: 8px; font-weight: bold; text-decoration: none; display: inline-block; text-align: center; font-size: 0.8rem; }
        
        #tablero { display: grid; grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); gap: 8px; }
        .card { background: #161616; border-radius: 12px; padding: 10px; border: 1px solid #222; text-align: center; cursor: pointer; }
        .card:active { border-color: #f3ba2f; }
        .logo { width: 22px; height: 22px; margin-bottom: 4px; }

        .history-panel { background: #111; padding: 15px; border-radius: 15px; border: 1px solid #333; margin-top: 15px; }
        table { width: 100%; font-size: 0.7rem; text-align: left; border-collapse: collapse; }
        th { color: #f3ba2f; border-bottom: 1px solid #333; padding-bottom: 5px; }
        td { padding: 5px 0; border-bottom: 1px solid #222; }
    </style>
</head>
<body>

    <div class="header">
        <div><h2 style="margin:0; font-size: 0.9rem; color: #f3ba2f;">CRYPTO TERMINAL</h2></div>
        <div style="text-align: right;">
            <div style="font-size: 0.6rem; color: #888;">SALDO VIRTUAL</div>
            <div class="balance-numb" id="saldo-usd">$10,000.00</div>
        </div>
    </div>

    <div id="contenedor-grafica">
        <div id="tradingview_chart" style="height: 100%;"></div>
    </div>

    <div class="trade-panel">
        <div style="display: flex; justify-content: space-between; font-weight: bold;">
            <span id="moneda-activa">BTC</span>
            <span id="precio-activo" style="color: #f3ba2f;">$0.00</span>
        </div>
        <input type="number" id="monto-operar" placeholder="Monto en USD">
        <div class="btn-group">
            <button class="btn-buy" onclick="ejecutarOrden('COMPRA')">Comprar</button>
            <button class="btn-sell" onclick="ejecutarOrden('VENTA')">Vender</button>
        </div>
        <a href="javascript:void(0)" class="btn-binance" onclick="irABinance()">OPERAR EN REAL (BINANCE)</a>
        <div id="status-msg" style="font-size: 0.7rem; color: #aaa; margin-top: 10px; text-align: center;"></div>
    </div>

    <div id="tablero"></div>

    <div class="history-panel">
        <h3 style="margin:0 0 10px 0; font-size: 0.8rem; color: #f3ba2f;">üìú HISTORIAL DE TRANSACCIONES</h3>
        <table>
            <thead><tr><th>Tipo</th><th>Moneda</th><th>Cantidad</th><th>Monto USD</th></tr></thead>
            <tbody id="historial-body"></tbody>
        </table>
    </div>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        const monedasIds = [
            'bitcoin', 'ethereum', 'solana', 'ripple', 'pepe', 'cardano', 
            'dogecoin', 'pax-gold', 'binancecoin', 'bitcoin-cash', 'litecoin', 'tron', 'usd-coin'
        ];
        
        let saldoActual = parseFloat(localStorage.getItem('saldo')) || 10000;
        let cartera = JSON.parse(localStorage.getItem('cartera')) || {};
        let historial = JSON.parse(localStorage.getItem('historial')) || [];
        let monedaActual = 'BTC';
        let precioActual = 0;

        function guardarDatos() {
            localStorage.setItem('saldo', saldoActual);
            localStorage.setItem('cartera', JSON.stringify(cartera));
            localStorage.setItem('historial', JSON.stringify(historial));
            document.getElementById('saldo-usd').innerText = `$${saldoActual.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
            actualizarTablaHistorial();
        }

        function actualizarTablaHistorial() {
            const body = document.getElementById('historial-body');
            body.innerHTML = historial.slice(-5).reverse().map(op => `
                <tr>
                    <td style="color:${op.tipo === 'COMPRA' ? '#0f0' : '#f44'}">${op.tipo}</td>
                    <td>${op.moneda}</td>
                    <td>${parseFloat(op.cantidad).toFixed(4)}</td>
                    <td>$${parseFloat(op.usd).toLocaleString()}</td>
                </tr>
            `).join('');
        }

        function cargarGrafica(symbol) {
            new TradingView.widget({
                "autosize": true, "symbol": "BINANCE:" + symbol + "USDT",
                "interval": "60", "theme": "dark", "style": "1",
                "container_id": "tradingview_chart", "hide_top_toolbar": true, "hide_legend": true
            });
        }

        async function actualizarMercado() {
            try {
                const res = await axios.get(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${monedasIds.join(',')}`);
                const tablero = document.getElementById('tablero');
                tablero.innerHTML = '';

                res.data.forEach(coin => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `<img class="logo" src="${coin.image}"><div>${coin.symbol.toUpperCase()}</div>
                                      <div style="font-weight:bold">$${coin.current_price < 1 ? coin.current_price.toFixed(4) : coin.current_price.toLocaleString()}</div>`;
                    card.onclick = () => {
                        monedaActual = coin.symbol.toUpperCase();
                        precioActual = coin.current_price;
                        document.getElementById('moneda-activa').innerText = monedaActual;
                        cargarGrafica(monedaActual);
                    };
                    tablero.appendChild(card);
                    if(coin.symbol.toUpperCase() === monedaActual) {
                        precioActual = coin.current_price;
                        document.getElementById('precio-activo').innerText = `$${precioActual.toLocaleString()}`;
                    }
                });
            } catch (e) { console.error("Error API"); }
        }

        function ejecutarOrden(tipo) {
            const monto = parseFloat(document.getElementById('monto-operar').value);
            const msg = document.getElementById('status-msg');
            if (!monto || monto <= 0) return;

            let cantidad = 0;
            if (tipo === 'COMPRA') {
                if (monto > saldoActual) { msg.innerHTML = "‚ùå Saldo insuficiente"; return; }
                saldoActual -= monto;
                cantidad = monto / precioActual;
                cartera[monedaActual] = (cartera[monedaActual] || 0) + cantidad;
                msg.innerHTML = `‚úÖ Compraste ${cantidad.toFixed(4)} ${monedaActual}`;
            } else {
                const posee = cartera[monedaActual] || 0;
                if (posee <= 0) { msg.innerHTML = "‚ùå No tienes fondos"; return; }
                cantidad = posee;
                const usdRecibido = posee * precioActual;
                saldoActual += usdRecibido;
                cartera[monedaActual] = 0;
                msg.innerHTML = `üíµ Vendiste por $${usdRecibido.toFixed(2)}`;
            }
            historial.push({ tipo, moneda: monedaActual, cantidad, usd: (tipo === 'COMPRA' ? monto : cantidad * precioActual) });
            guardarDatos();
        }

        function irABinance() {
            if (confirm("‚ö†Ô∏è ADVERTENCIA: Operar en real implica riesgo. ¬øIr a Binance con ID: GRO_28502_VU9YR?")) {
                window.open("https://www.binance.com/referral/earn-together/refer2earn-usdc/claim?hl=es-LA&ref=GRO_28502_VU9YR", "_blank");
            }
        }

        guardarDatos();
        cargarGrafica("BTC");
        actualizarMercado();
        setInterval(actualizarMercado, 30000);
    </script>
</body>
</html>


