<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Terminal Pro - Simulator</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #050505; color: white; padding: 10px; margin: 0; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #111; border-radius: 12px; margin-bottom: 10px; border: 1px solid #333; }
        .balance-numb { color: #00ff00; font-weight: bold; font-size: 1.1rem; }
        
        #contenedor-grafica { width: 100%; height: 280px; background: #000; border-radius: 15px; overflow: hidden; margin-bottom: 15px; border: 1px solid #333; }
        
        .trade-panel { background: #111; padding: 15px; border-radius: 15px; border: 1px solid #333; margin-bottom: 15px; }
        input { width: 100%; background: #222; border: 1px solid #444; color: white; padding: 12px; margin: 10px 0; border-radius: 8px; box-sizing: border-box; }
        
        .btn-group { display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .btn-buy { background: #00ff00; color: #000; }
        .btn-sell { background: #ff4444; color: #fff; }
        
        /* Bot√≥n de Binance */
        .btn-binance { background: #f3ba2f; color: #000; width: 100%; margin-top: 15px; padding: 10px; border-radius: 8px; font-weight: bold; text-decoration: none; display: inline-block; text-align: center; }
        
        #tablero { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; }
        .card { background: #161616; border-radius: 12px; padding: 10px; border: 1px solid #222; text-align: center; cursor: pointer; }
        .card:active { border-color: #f3ba2f; }
        .logo { width: 25px; height: 25px; }
    </style>
</head>
<body>

    <div class="header">
        <div><h2 style="margin:0; font-size: 0.9rem; color: #f3ba2f;">CRYPTO SIMULATOR</h2></div>
        <div style="text-align: right;">
            <div style="font-size: 0.6rem; color: #888;">SALDO VIRTUAL</div>
            <div class="balance-numb" id="saldo-usd">$10,000.00</div>
        </div>
    </div>

    <div id="contenedor-grafica">
        <div id="tradingview_chart" style="height: 100%;"></div>
    </div>

    <div class="trade-panel">
        <div style="display: flex; justify-content: space-between; font-weight: bold;">
            <span id="moneda-activa">BTC</span>
            <span id="precio-activo" style="color: #f3ba2f;">$0.00</span>
        </div>
        <input type="number" id="monto-operar" placeholder="Monto en USD">
        <div class="btn-group">
            <button class="btn-buy" onclick="ejecutarOrden('COMPRA')">Comprar</button>
            <button class="btn-sell" onclick="ejecutarOrden('VENTA')">Vender</button>
        </div>
        
        <a href="javascript:void(0)" class="btn-binance" onclick="irABinance()">OPERAR EN REAL (BINANCE)</a>
        
        <div id="status-msg" style="font-size: 0.7rem; color: #aaa; margin-top: 10px; text-align: center;"></div>
    </div>

    <div id="tablero"></div>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        const monedasIds = ['bitcoin', 'ethereum', 'solana', 'ripple', 'pepe', 'cardano', 'dogecoin', 'pax-gold', 'binancecoin'];
        
        // CARGAR DATOS GUARDADOS O INICIALIZAR
        let saldoActual = parseFloat(localStorage.getItem('saldo')) || 10000;
        let cartera = JSON.parse(localStorage.getItem('cartera')) || {};
        let monedaActual = 'BTC';
        let precioActual = 0;

        function guardarDatos() {
            localStorage.setItem('saldo', saldoActual);
            localStorage.setItem('cartera', JSON.stringify(cartera));
            document.getElementById('saldo-usd').innerText = `$${saldoActual.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        }

        function cargarGrafica(symbol) {
            new TradingView.widget({
                "autosize": true, "symbol": "BINANCE:" + symbol + "USDT",
                "interval": "60", "theme": "dark", "style": "1",
                "container_id": "tradingview_chart", "hide_top_toolbar": true, "hide_legend": true
            });
        }

        async function actualizarMercado() {
            try {
                const res = await axios.get(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${monedasIds.join(',')}`);
                const tablero = document.getElementById('tablero');
                tablero.innerHTML = '';

                res.data.forEach(coin => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `<img class="logo" src="${coin.image}"><div>${coin.symbol.toUpperCase()}</div>
                                      <div style="font-weight:bold">$${coin.current_price < 1 ? coin.current_price.toFixed(4) : coin.current_price.toLocaleString()}</div>`;
                    card.onclick = () => {
                        monedaActual = coin.symbol.toUpperCase();
                        precioActual = coin.current_price;
                        document.getElementById('moneda-activa').innerText = monedaActual;
                        cargarGrafica(monedaActual);
                    };
                    tablero.appendChild(card);
                    if(coin.symbol.toUpperCase() === monedaActual) {
                        precioActual = coin.current_price;
                        document.getElementById('precio-activo').innerText = `$${precioActual.toLocaleString()}`;
                    }
                });
            } catch (e) { console.error("Error API"); }
        }

        function ejecutarOrden(tipo) {
            const monto = parseFloat(document.getElementById('monto-operar').value);
            const msg = document.getElementById('status-msg');
            if (!monto || monto <= 0) return;

            if (tipo === 'COMPRA') {
                if (monto > saldoActual) { msg.innerHTML = "‚ùå Saldo insuficiente"; }
                else {
                    saldoActual -= monto;
                    cartera[monedaActual] = (cartera[monedaActual] || 0) + (monto / precioActual);
                    msg.innerHTML = `‚úÖ Compra exitosa de ${monedaActual}`;
                }
            } else {
                const posee = cartera[monedaActual] || 0;
                if (posee <= 0) { msg.innerHTML = "‚ùå No tienes fondos"; }
                else {
                    saldoActual += posee * precioActual;
                    cartera[monedaActual] = 0;
                    msg.innerHTML = `üíµ Venta exitosa`;
                }
            }
            guardarDatos();
        }

        function irABinance() {
            const confirmacion = confirm("‚ö†Ô∏è ADVERTENCIA DE RIESGO: Est√°s saliendo del simulador. Operar en mercados reales implica p√©rdida de capital. ¬øDeseas continuar a Binance?");
            if (confirmacion) {
                window.open("https://www.binance.com/referral/earn-together/refer2earn-usdc/claim?hl=es-LA&ref=GRO_28502_VU9YR", "_blank");
            }
        }

        guardarDatos();
        cargarGrafica("BTC");
        actualizarMercado();
        setInterval(actualizarMercado, 30000);
    </script>
</body>
</html>

